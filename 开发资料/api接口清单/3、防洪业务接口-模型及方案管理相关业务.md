# 防洪业务接口-模型及方案管理相关业务

## 一、模拟方案管理接口（13个）

### 1. modelPlan_add

**用途**: 新增模拟方案
**请求方式**: POST
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/add`
**输入参数**:

- Content-Type: application/json
- 请求体JSON对象:
  - planName: 方案名称 (String, 必填)
  - planDesc: 方案描述 (String, 可选)
  - businessCode: 业务模型编码 (String, 必填)
  - businessName: 业务模型名称 (String, 可选)
  - startTime: 开始时间 (String, 格式: "yyyy-MM-dd HH:mm:ss")
  - endTime: 结束时间 (String, 格式: "yyyy-MM-dd HH:mm:ss")
  - stepSaveMinutes: 模型结果保存时间步长(分钟) (Integer, 可选)
  - inheritPlanCode: 继承方案的编码 (String, 可选)
  - viewPoint: 相机位置 (String, 可选)
  - modelObject: 模型参数JSON字符串 (String, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

### 2. modelPlan_edit

**用途**: 编辑模拟方案
**请求方式**: POST
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/edit`
**输入参数**:

- Content-Type: application/json
- 请求体JSON对象: 同新增接口参数
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

### 3. modelPlan_delete

**用途**: 删除模拟方案
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/delete`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

### 4. modelPlan_detail

**用途**: 查看模拟方案详情
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/detail`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "planCode": "plan_20231201",
        "planName": "测试方案",
        "planDesc": "方案描述",
        "businessCode": "business001",
        "businessName": "业务模型名称",
        "startTime": "2023-12-01 00:00:00",
        "endTime": "2023-12-02 00:00:00",
        "state": "待计算",
        "stepSaveMinutes": 60,
        "expectSeconds": 300,
        "progressInfo": "进度信息",
        "viewPoint": "相机位置JSON",
        "modelObject": "模型参数JSON"
    }
}
```

### 5. modelPlan_state

**用途**: 查看模拟方案计算状态
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/state`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": "计算完成"
}
```

### 6. modelPlan_listAll

**用途**: 查询全部模拟方案列表(不分页)
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/listAll`
**输入参数**:

- planCode: 方案编码 (String, 可选)
- planName: 方案名称 (String, 可选)
- businessCode: 业务模型编码 (String, 可选)
- state: 计算状态 (String, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": [
        {
            "planCode": "plan_001",
            "planName": "方案1",
            "businessCode": "business001",
            "state": "计算完成"
        }
    ]
}
```

### 7. modelPlan_calc

**用途**: 执行模拟方案计算
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/calc`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "expectSeconds": 300
    }
}
```

### 8. modelPlan_stop

**用途**: 终止模拟方案计算
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/stop`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

### 9. modelPlan_progress

**用途**: 获取模拟方案计算进度
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/progress`
**输入参数**:

- planCode: 方案编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "progress": 50,
        "info": "正在计算..."
    }
}
```

### 10. modelPlan_countState

**用途**: 获取不同计算状态的方案数量统计
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/count/state`
**输入参数**: 无
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "待计算": 10,
        "计算中": 2,
        "计算完成": 50,
        "计算失败": 3
    }
}
```

### 11. modelPlan_countPlan

**用途**: 获取各业务模型的模拟方案数量
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/count/plan`
**输入参数**: 无
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "business001": 20,
        "business002": 15
    }
}
```

### 12. modelPlan_autoForecastManual

**用途**: 手动执行一次自动预报(无需登录)
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelPlan/autoForecast/manual`
**输入参数**: 无
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

---

## 二、基础模型管理接口（3个）

### 13. modelBasic_listAll

**用途**: 查询全部基础模型列表(不分页)
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBasic/listAll`
**输入参数**:

- name: 模型名称 (String, 可选)
- code: 模型编码 (String, 可选)
- typeId: 模型类型ID (Long, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": [
        {
            "id": 1,
            "name": "新安江模型",
            "code": "XAJ",
            "typeId": 1,
            "typeName": "产流模型"
        }
    ]
}
```

### 14. modelBasic_detail

**用途**: 查看基础模型详情
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBasic/detail`
**输入参数**:

- id: 模型ID (Long, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "id": 1,
        "name": "新安江模型",
        "code": "XAJ",
        "summary": "模型介绍",
        "principle": "模型原理",
        "resultDesc": "生成结果描述",
        "typeId": 1,
        "typeName": "产流模型",
        "imgId": 100,
        "paras": []
    }
}
```

### 15. modelBasic_count

**用途**: 获取基础模型、模型实例、业务模型、模拟方案的数量统计
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBasic/count`
**输入参数**: 无
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "basicCount": 10,
        "instanceCount": 20,
        "businessCount": 5,
        "planCount": 100
    }
}
```

---

## 三、模型实例管理接口（2个）

### 16. modelInstance_listAll

**用途**: 查询全部模型实例列表(不分页)
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelInstance/listAll`
**输入参数**:

- name: 实例名称 (String, 可选)
- code: 实例编码 (String, 可选)
- basicCode: 基础模型编码 (String, 可选)
- basinCode: 流域编码 (String, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": [
        {
            "id": 1,
            "name": "卫河流域新安江模型",
            "code": "WH_XAJ",
            "basicCode": "XAJ",
            "basinCode": "WH001"
        }
    ]
}
```

### 17. modelInstance_detail

**用途**: 查看模型实例详情
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelInstance/detail`
**输入参数**:

- id: 实例ID (Long, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "id": 1,
        "name": "卫河流域新安江模型",
        "code": "WH_XAJ",
        "summary": "实例介绍",
        "resultDesc": "生成结果描述",
        "typeId": 1,
        "typeName": "产流模型",
        "basicCode": "XAJ",
        "basicName": "新安江模型",
        "basinCode": "WH001",
        "paras": []
    }
}
```

---

## 四、业务模型管理接口（4个）

### 18. modelBusiness_listAll

**用途**: 查询全部业务模型列表(不分页)
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBusiness/listAll`
**输入参数**:

- name: 业务模型名称 (String, 可选)
- code: 业务模型编码 (String, 可选)
- typeId: 业务模型类型ID (Long, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": [
        {
            "id": 1,
            "name": "卫河流域洪水预报",
            "code": "WH_FLOOD",
            "typeId": 1,
            "typeName": "洪水预报"
        }
    ]
}
```

### 19. modelBusiness_add

**用途**: 新增业务模型
**请求方式**: POST
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBusiness/add`
**输入参数**:

- Content-Type: application/json
- 请求体JSON对象:
  - name: 业务模型名称 (String, 必填)
  - code: 业务模型编码 (String, 必填, 唯一)
  - typeId: 业务模型类型ID (Long, 可选)
  - typeName: 业务模型类型名称 (String, 可选)
  - instanceCodes: 模型实例编码(多个用逗号分隔) (String, 可选)
  - viewPoint: 相机位置 (String, 可选)
  - url: 模型地址 (String, 可选)
  - remark: 备注 (String, 可选)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": null
}
```

### 20. modelBusiness_detail

**用途**: 查看业务模型详情
**请求方式**: GET
**请求路径**: `http://10.20.2.153:8089/modelPlatf/model/modelBusiness/detail`
**输入参数**:

- code: 业务模型编码 (String, 必填)
**输出结果**:

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {
        "id": 1,
        "name": "卫河流域洪水预报",
        "code": "WH_FLOOD",
        "typeId": 1,
        "typeName": "洪水预报",
        "instanceCodes": "WH_XAJ,WH_MIKE11",
        "viewPoint": "相机位置JSON",
        "url": "模型地址",
        "remark": "备注"
    }
}
```

---

## 统一响应格式

所有接口返回统一的JSON格式：

```json
{
    "success": true,
    "code": "200",
    "message": "请求成功",
    "data": {}
}
```

错误时返回：

```json
{
    "success": false,
    "code": "500",
    "message": "错误信息",
    "data": null
}
```

---

## 附录

### A. 日期格式说明

所有日期参数格式为: `yyyy-MM-dd HH:mm:ss`
示例: `2023-12-01 00:00:00`

### B. 状态码说明

- 200: 请求成功
- 500: 服务器内部错误
- 401: 未授权(需要登录)
- 403: 禁止访问

### C. 计算状态说明

模拟方案计算状态包括:

- 待计算
- 计算中
- 计算完成
- 计算失败

### D. 无需登录的接口

以下接口无需登录(requiredLogin = false):

- modelPlan_autoForecastManual
