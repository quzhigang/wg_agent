# 获取专业模型参数及边界条件相关接口

## 概述

本文档描述了卫共数字孪生流域获取专业模型参数及边界条件信息的API接口，共8个接口。接口的输入输出参数均有完整描述，输出一般都有返回的结果样例，全部接口均基于ASP.NET项目构建，所有接口通过Model_Ser.ashx.cs处理。每个接口都包含详细的输入参数说明和输出结果格式，其接口地址统一为：<http://172.16.16.253/wg_modelserver/hd_mike11server/Model_Ser.ashx>

---

## 接口列表

### 1. get_rfmodel

**用途**: 获取方案的产汇流模型类型
**请求方式**: GET
**输入参数**:

- request_type: "get_rfmodel"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的产汇流模型类型字典, 为Dictionary<string, string> 类型序列化结果，
  其中属性为各子流域编码，值为该子流域采用的产汇流模型编码，共3种:"nam"、"swmm5"、"xaj"

### 2. get_reach_break

**用途**: 获取方案河堤溃口设置信息
**请求方式**: GET
**输入参数**:

- request_type: "get_reach_break"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的溃口设置信息，样例结果：
  {
      "str_name": "GQ_KB",         //溃口编码
      "name": "卫辉共渠右堤决口",   //溃口名称
      "location": [                //溃口经纬度位置
          113.917822,
          35.368627
      ],
      "fh_width": 200.0,               //溃口宽(米)
      "fh_minutes": 30.0,              //溃堤时长(分钟)
      "break_condition": "max_level",  //溃决时机描述 - "max_level"(河道水位达到最高水位) 或 "set_level"(指定河道水位)
      "break_level": 70.60,            //溃决水位
      "fh_datumn": 71.711,             //溃口底高程
      "fh_start_time": "2030/07/01 12:10:00",  //开始溃口时间
      "fh_finish_time": "2030/07/01 12:40:00"  //溃口完成时间
  }

### 3. get_faultgate_baseinfo

**用途**: 获取故障水闸的闸门基本信息，根据业务编码获取，一个业务编码对应一个故障水闸
**请求方式**: GET
**输入参数**:

- request_type: "get_faultgate_baseinfo"
- request_pars: 业务编码字符串 (business_code)
**输出结果**:
- JSON格式的故障闸门基础信息，样例：
  {
      "str_name": "GQ_YTZJZZ",     //建筑物编码
      "cn_name": "盐土庄节制闸",    //建筑物名称
      "gate_info": [                //建筑物各闸门信息，包括编码、名称、闸底高程、闸门高度、闸门经纬度坐标
          {
              "gate_code": "YTZ_JZZ1",
              "gate_name": "1#闸门",
              "gate_bottom": 53.0,
              "gate_h": 10.0,
              "gate_jd": 114.478034973145,
              "gate_wd": 35.7404365539551
          },
          {
              "gate_code": "YTZ_JZZ2",
              "gate_name": "2#闸门",
              "gate_bottom": 53.0,
              "gate_h": 10.0,
              "gate_jd": 114.478164672852,
              "gate_wd": 35.7403984069824
          },
          ...
      ]
  }

### 4. get_fault_gate

**用途**: 获取方案的故障闸门信息
**请求方式**: GET
**输入参数**:

- request_type: "get_fault_gate"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的故障闸门信息，样例：
  {
      "gate_name": "盐土庄节制闸",         //故障水闸名称
      "fault_type": "部分闸门无法开启",    //故障描述
      "gate_h": [                         //水闸各闸门最大开度和当前开度
          ["1#闸门",10.0,10.0],
          ["2#闸门",10.0,0.0],
          ...
      ],
      "fault_gate": "2#闸门、4#闸门、5#闸门",   //各故障闸门名称
      "fault_gate_jwd": {                      //各故障闸门经纬度
          "2#闸门": [
              114.478164672852,
              35.7403984069824
          ],
          "4#闸门": [
              114.47843170166,
              35.7403373718262
          ],
          "5#闸门": [
              114.478561401367,
              35.7403106689453
          ]
      }
  }

### 5. get_ddinfo

**用途**: 获取模型方案所有可控建筑物的调度信息
**请求方式**: GET
**输入参数**:

- request_type: "get_ddinfo"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的调度信息，样例：
  [
      [
          "XYC_FHY",         //可控建筑物编码
          "1",               //序号
          "西沿村分洪堰",     //可控建筑物名称
          "分洪堰",           //可控建筑物类型
          "西沿村溃口支流",    //可控建筑物所在河道名称
          "[["","全关","0","0"]]"   //可控建筑物闸门调度过程
      ],
      [
          "CHQ_FHY",
          "2",
          "长虹渠分洪堰",
          "分洪堰",
          "长虹渠溃口支流",
          "[["","全关","0","0"]]"
      ],
      ...
  ]
  可控建筑物闸门调度过程，格式为：[["时间1"，"操作类型1"，"闸孔数","值"],["时间2"，"操作类型2"，"闸孔数","值"],..]，当时间为空字符串时，表示全过程采用一组闸门操作，闸门状态不再随时间变化，操作类型分为"全开"、"全关"、"半开"、"控泄"、"规则调度"

### 6. get_initial_waterlevel

**用途**: 获取模型方案的初始水情信息
**请求方式**: GET
**输入参数**:

- request_type: "get_initial_waterlevel"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的初始水情信息，样例：
  {
      "水库": [             //各水库的初始水情
          [
              1,              //序号
              "陈家院水库",    //水库名称
              754.12,         //初始水位
              "人为指定",      //初始水位来源
              "31005550"      //水库stcd编码
          ],
          [
              2,
              "三郊口水库",
              626.35,
              "人为指定",
              "31005580"
          ],
          ...
      ],
      "河道": [            //各河道站点的初始水情
          [
              1,            //序号
              "汲县",       //河道水文站点名称
              64.7,         //初始水位
              "人为指定",    //初始水位来源
              "31003600"    //水文站点stcd编码
          ],
          [
              2,
              "淇门",
              58.87,
              "人为指定",
              "31003700"
          ],
          ...
      ]
  }

### 7. get_bndinfo

**用途**: 获取模型方案的边界条件信息
**请求方式**: GET
**输入参数**:

- request_type: "get_bndinfo"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的边界条件信息，样例：
  {
      "bnd_type": "降雨计算洪水",     //边界条件类型描述
      "bnd_value": {                 //边界条件值
          "cdpg_all": {
              "2023/07/28 08:00:00": 0.08,
              "2023/07/28 08:30:00": 0.08,
              ...
          },
          "zqh_all": {
              "2023/07/28 08:00:00": 0.0,
              "2023/07/28 08:30:00": 0.0,
              ...
          },
        ...
      }
  }

### 8. get_dispatch_target

**用途**: 获取方案的优化调度目标设置信息
**请求方式**: GET
**输入参数**:

- request_type: "get_dispatch_target"
- request_pars: 方案ID字符串
**输出结果**:
- JSON格式的优化调度目标信息，样例：
  [
      "model_20241007110000",   //方案ID
      {                         //调度目标
          "name": "元村",
          "stcd": "31004300",
          "max_discharge": 2500
      },
      [                         //各水库的约束水位
          {
              "name": "双泉水库",
              "stcd": "31006950",
              "level_name": "防洪高水位",
              "level_value": 142.3
          },
          ...
      ],
      {                       //闸门过流能力、河道过流能力、蓄滞洪区水位的约束
          "gate": true,
          "reach": true,
          "xzhq_level": true
      }
  ]

---

## 总结

本文档共收录8个获取专业模型参数及边界条件信息的API接口，包括：
1. get_rfmodel - 获取方案的产汇流模型类型
2. get_reach_break - 获取方案河堤溃口设置信息
3. get_faultgate_baseinfo - 获取故障水闸的闸门基本信息
4. get_fault_gate - 获取方案的故障闸门信息
5. get_ddinfo - 获取模型方案所有可控建筑物的调度信息
6. get_initial_waterlevel - 获取模型方案的初始水情信息
7. get_bndinfo - 获取模型方案的边界条件信息
8. get_dispatch_target - 获取方案的优化调度目标设置信息
