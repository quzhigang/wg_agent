## 按语义搜索文档

对于涵盖不同主题的文档，也可以使用基于向量的语义搜索来搜索文档。该过程与经典的基于向量搜索的方法略有不同。

### 示例流程


#### 分块和嵌入
将文档分成块，选择一个嵌入模型将块转换为向量，并将每个向量及其对应的 `doc_id` 存储在向量数据库中。


#### 向量搜索

对于每个查询，进行基于向量的搜索以获取 top-K 个块及其对应的文档。

#### 计算文档得分

对于每个文档，计算相关性得分。设 N 为与每个文档关联的内容块数量，设 **ChunkScore**(n) 为第 n 个块的相关性得分。文档得分计算如下：


$$
\text{DocScore}=\frac{1}{\sqrt{N+1}}\sum_{n=1}^N \text{ChunkScore}(n)
$$

- 求和聚合了所有相关块的相关性。
- 平方根内的 +1 确保公式能处理零块的节点。
- 在分母中使用平方根允许得分随相关块数量增加而增加，但增幅递减。这奖励具有更多相关块的文档，同时防止大节点仅因数量而占主导地位。
- 此评分方法偏向于具有较少但高度相关块的文档，而非具有许多弱相关块的文档。


#### 使用 PageIndex 检索

选择 DocScore 最高的文档，然后使用其 `doc_id` 通过 PageIndex 检索 API 进行进一步检索。



## 💬 帮助与社区
如果您需要针对您的用例进行文档搜索的任何建议，请联系我们。

- 🤝 [加入我们的 Discord](https://discord.gg/VuXuf29EUj)  
- 📨 [给我们留言](https://ii2abc2jejf.typeform.com/to/meB40zV0)
