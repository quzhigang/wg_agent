---
description: 分析并记录 GitHub 问题的根本原因
argument-hint: [github-问题-id]
---

# 根本原因分析 (Root Cause Analysis): GitHub Issue #$ARGUMENTS

## 目标 (Objective)

调查本仓库的 GitHub 问题 #$ARGUMENTS，识别根本原因，并记录调查结果以供后续实施修复之用。

**前提条件：**

- 在具有 GitHub 源 (origin) 的本地 Git 仓库中工作
- 已安装并验证 GitHub CLI (`gh auth status`)
- 来自本仓库的有效 GitHub 问题 ID

## 调查流程 (Investigation Process)

### 1. 获取 GitHub 问题详情 (Fetch GitHub Issue Details)

**使用 GitHub CLI 检索问题信息：**

```bash
gh issue view $ARGUMENTS
```

这将获取：

- 问题的标题和描述
- 报告者和创建日期
- 标签和状态
- 评论和讨论内容

### 2. 搜索代码库 (Search Codebase)

**识别相关代码：**

- 搜索问题中提到的组件
- 查找相关的函数、类或模块
- 检查类似的实现方式
- 寻找模式或最近的更改

使用 grep/search 查找：

- 问题中的错误消息
- 相关函数名
- 组件标识符

### 3. 查看最近历史记录 (Review Recent History)

检查受影响区域最近的更改：
!`git log --oneline -20 -- [相关路径]`

寻找：

- 受影响代码最近的修改记录
- 相关的错误修复
- 可能引入该问题的重构工作

### 4. 调查根本原因 (Investigate Root Cause)

**通过分析代码以确定：**

- 实际的 Bug 或问题是什么？
- 为什么会发生？
- 原始意图是什么？
- 这是一个逻辑错误、边缘情况还是缺失了验证？
- 是否存在相关的问题或症状？

**考虑以下因素：**

- 输入验证失败
- 未处理的边缘情况
- 竞态条件或时序问题
- 错误的假设
- 缺少错误处理
- 组件间的集成问题

### 5. 评估影响 (Assess Impact)

**确定：**

- 这个问题的影响范围有多广？
- 哪些功能受到影响？
- 是否有变通方法 (Workarounds)？
- 严重程度如何？
- 是否可能导致数据损坏或安全问题？

### 6. 提议修复方法 (Propose Fix Approach)

**设计解决方案：**

- 需要更改什么？
- 哪些文件将被修改？
- 修复策略是什么？
- 是否有备选方案？
- 需要进行哪些测试？
- 是否存在风险或副作用？

## 输出：创建 RCA 文档 (Output: Create RCA Document)

将分析结果保存至：`docs/rca/issue-$ARGUMENTS.md`

### 必填的 RCA 文档结构 (Required RCA Document Structure)

```markdown
# 根本原因分析 (Root Cause Analysis): GitHub Issue #$ARGUMENTS

## 问题总结 (Issue Summary)

- **GitHub 问题 ID**: #$ARGUMENTS
- **问题 URL**: [GitHub 问题链接]
- **标题**: [来自 GitHub 的问题标题]
- **报告者**: [GitHub 用户名]
- **严重程度**: [致命/高/中/低]
- **状态**: [当前 GitHub 问题状态]

## 问题描述 (Problem Description)

[对该问题的清晰描述]

**期望行为：**
[应当发生的情况]

**实际行为：**
[实际发生的情况]

**症状：**
- [列出观察到的症状]

## 复现 (Reproduction)

**复现步骤：**
1. [步骤 1]
2. [步骤 2]
3. [观察问题]

**复现已验证：** [是/否]

## 根本原因 (Root Cause)

### 受影响组件

- **文件**: [受影响文件及其路径列表]
- **函数/类**: [具体代码位置]
- **依赖项**: [涉及的任何外部依赖]

### 分析 (Analysis)

[关于根本原因的详细解释]

**发生原因：**
[对底层问题的解释]

**代码位置：**
```

[文件路径:行号]
[显示问题的相关代码片段]

```

### 相关问题

- [任何相关的问题或模式]

## 影响评估 (Impact Assessment)

**范围：**
- [影响范围有多广？]

**受影响功能：**
- [列出受影响的功能]

**严重程度理由：**
[为何定位此严重级别]

**数据/安全隐患：**
[任何数据损坏或安全方面的影响]

## 建议修复 (Proposed Fix)

### 修复策略

[修复的高层思路]

### 待修改文件

1. **[文件路径]**
   - 更改：[需要做哪些更改]
   - 原因：[为何此更改能修复问题]

2. **[文件路径]**
   - 更改：[需要做哪些更改]
   - 原因：[为何此更改能修复问题]

### 备选方案

[其他可能的解决方案，以及为何建议的方案更好]

### 风险与考虑因素

- [该修复方案存在的任何风险]
- [涉及的副作用]
- [是否存在任何破坏性变更]

### 测试要求

**所需测试用例：**
1. [测试用例 1 - 验证修复是否奏效]
2. [测试用例 2 - 验证没有出现回归]
3. [测试用例 3 - 边缘情况]

**验证命令：**
```bash
[验证修复的确切命令]
```

## 实施计划 (Implementation Plan)

[实施步骤的简要概述]

此 RCA 文档应由 `/implement-fix` 命令使用。

## 后续步骤 (Next Steps)

1. 评审该 RCA 文档
2. 运行：`/implement-fix $ARGUMENTS` 来实施修复
3. 实施完成后运行：`/commit`

```
